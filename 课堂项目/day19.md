# day19
## 整合权限管理框架
#### shiro+thymeleaf权限管理
之前的项目使用thymeleaf，整合shiro进行授权就变得很方便。所有有关权限的操作都是在服务端进行的，可以很方便的在模板引擎中使用标签来控制组件资源，使用注解来拦截相应的请求。

### 本项目的不同
由于本项目使用的是前后端分离的方式进行开发的，而且用的vue也不是服务端渲染的，所以权限控制也需要分离。
### 思路
![流程图](/流程图/springsecurity流程.jpg)
其实没怎么用到springsecurity的功能，后端只是进行一个登录，然后每次请求授权拦截判断一下token，只不过这些都交给了springsecurity进行管理了。

### 前端思路
这个授权主要在于前端，后端说白了就是在登陆的时候同时返回了menu和params，前端将这些进行进行持久化，然后对资源进行判断。
- 其中使用vue-router的拦截全局拦截功能，在`permission.js`中进行拦截，动态生成路由，不过要注意返回路由数据的格式。
- 使用vuex的持久化组件将所有菜单列表和参数进行存储。
- 退出的时候将持久化数据清除。

## 权限管理
建三张表，分别是user、role、permission，其中它们两两之间都是多对多的关系，所以我们需要在user和role、role和permission之间都要建立中间表，建立对应关系，所以在对权限进行增删改查的需要注意到这一点。
