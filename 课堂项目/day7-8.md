# day7-8
## 课程管理

### 添加课程基本信息接口
描述表和信息表分开的，id号得一致。

### 添加课程基本信息前端
1. 使用element-ui组件中的步骤条，配合vue隐藏路由进行整合。当点击保存下一步的时候路由到相应的路径中：`this.$router.push({path: '/course/chapter/')`
2. 路由页面也是类似的进度条，改变其中的action值从而使视图变成下一步。路由中采用`/chapter/:id`的形式，这是因为下一步需要用到前面一步的信息，所以需要将课程的id号通过路由的形式传到下一步页面中。
3. 上传封面的时候使用`upload`组件。

#### 整合文本编辑器TinyMCE：课程简介
- 整合过程：不懂，按照它的步骤来。
![整合文本编辑器过程](../截图/02-整合文本编辑器过程.png)
- 会将description进行markdown后，按照json的数据传给后端。
- 由于没有图片服务器，所以它仅仅是对图片内容进行`base64`编码后，再传给接口。

#### 注意问题
- 在js中写循环的时候，如果要拿到data中元素，一定在前面加上`this`。
- 二级联动的精髓：第一个下拉框中触发相应的事件。


### 点击上一步的页面回显和接口编写
- 将url后面的id发给接口，返回回显数据。
- 当点击下一步的时候，需要进行更新操作而不是添加操作。使用mp里的`saveOrUpdate`方法。
#### 坑点
- 二级联动的回显：详见异步请求的博客。
- 在上一步界面中，如果点击添加的路由，那么页面不会刷新，这时候使用`watch`监听器来实现重新加载数据：
 ```js
     watch:{  //当多个路由请求连续请求一个component的时候，正常来说component是不会加载的，但是我们可以设置监听器来监听路由的变化。
      $route(to,from){
          debugger
          this.init()
      }
    }
 ```
 但是要记住，路由仅仅是执行一个方法，原本页面的数据该在还是在。
 - <font color=red>vue的data坑点：`{}`和`''`的区别，使用`{}`代表这个数据是一个json类型的数据，里面会有很多属性，但是属性没有值；如果使用`''`代表这个值是个字符串，这个字符串为空。</font>

### 章节管理接口
添加、删除、更新、查询章节的接口编写。
### 课程章节前端
1. 整合elemet-ui的弹框组件`el-dialog`，它绑定了一个属性，可以通过对属性设置`true or false`来进行弹框的弹出和关闭。
2. 不管是添加、删除、更新成功后都请求接口获取所有数据，将返回的data使用`<ul> <li>`进行章节和小节的级层显示。
3. 更新数据的时候，发送数据是通过`@click="openModify(chapter.id)"`来进行请求方法的，这也就是层级中`:key`的作用（唯一标识）。
4. 小节和章节差不多，一样去做就行。

#### 坑点
- `<el-button>`的bug，下面表单中有button的时候，ul li里面的button无法被选中。换个浏览器又行了，这个纯属谷歌的bug。form表单和button之间的样式bug。

### 最终发布的数据回显
#### 接口部分
需要将课程表和其他几张表进行外连接操作。自己写一个sql放到`mapper.xml`中即可。
#### 坑点
- 使用mp生成的代码，如果xml文件夹放到了java目录下，那么在编译后maven只会编译java包下的java文件，xml文件不会放在target目录下，所以执行会失败。

解决方法：
1. 此时需要自己进行置使得项目会对xml文件夹进行加载。
2. 直接将xml文件夹放到target目录中。

#### 前端部分
使用`{{}}`取到接口返回的值，在添加一下css样式，当点击发布跳转到课程列表界面即可。








