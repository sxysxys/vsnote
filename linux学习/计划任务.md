## 计划任务的种类
- `at`:只执行一次的任务。设置在某一个时间执行一次。
- `cron`:循环执行的任务，到了特定的时间就执行。

## at
#### 执行at的步骤
1. 开启atd服务，如果没有打开的话通过systemctl打开。
2. 默认账户都能够直接创建at服务（如果不想要某些账户用at的话可以在`/etc/at.allow`和`/etc/at.deny`中进行开启或关闭，如果没有这两个文件，那么只有root能执行at），直接`at 时间`，在下一步输入需要执行的指令，按`ctrl+d`结束。

#### at任务管理
- 如果执行了at以后，发现输错了，此时通过`atq`查看计划任务，找到相应的计划任务后，通过`atrm 任务`删除即可。
- `batch`：系统有空的时候才执行后台任务，同样调用at，只不过要在系统cpu负载变成0.8以下才会执行这个任务。

#### at的注意事项
1. at的指令规定的工作任务都是后台任务。设置好at后，后面就是等待atd去执行它了，和你linux主机使用无关。
2. at的任务的时间最小单位是一分钟检查一次。
3. at的任务以文本的形式写到了`/var/spool/at/目录`。

## 循环执行任务cron
#### 执行的步骤
1. crond会主动的每隔一分钟读取一次`/etc/crontab /var/spool/cron/* /etc/cron.d/*`等配置文件，在这些文件中读取相应的定时命令（每时、天、月需要执行的指令），去进行定时任务的配置。
2. 由于上述的`/etc/cron.d`中有一个`0hourly`文件，这个文件每隔一个小时执行一个脚本，而脚本的内容是执行`/etc/cron.hourly/目录`下的所有脚本。这就是一个小时的定时任务。
3. 而每日、周、月的定时任务由什么完成呢？因为`/etc/cron.hourly`下有一个`0anacron`文件，所以它也是每小时执行的任务之一，这个文件会去执行anacron程序，调用`/etc/anacrontab`这个配置文件。
4. `/etc/anacrontab`会分别每天每周每月去分析`/etc/cron.daily/`等文件的执行文件，从而执行相应的任务；<font color=red>注意ananron它可以错时执行，就算任务错过了也能执行</font>。

#### 注意事项
1. `/etc/crontab`中的定时任务每个用户都能读取到，一般用于系统任务的同一管理。
2. 如果用户自己想添加定时任务，一般使用`crontab -e 定时任务语法`来进行添加，这个定时任务会加到`/var/spool/cron/用户`中，适合用户自己添加简单的定时任务。
3. 如果是软件需要有定时任务，一般添加到`/etc/cron.d/文件名`中，比较好管理。
4. 有时候加入有些任务都是每5分钟执行一次，那么这时候如果都是同一个时间点全部同时执行的话就会造成系统负载过大，这时候可以编辑`/etc/crontab`进行错开配置。
5. <font color=red>需要自己再去好好看一些定时执行的语法以及语法中一些符号的意思等。</font>


## 总结
<font color=red>at和cron都是脱离了用户的shell层面的后台任务，属于系统的后台任务,和用户是否脱机（是否获得相应的login bash无关）。</font>
在at和cron中对于用户的配置指的一般有两种：
1. 指定输出流（不管正确或错误）以email的形式发给哪个用户,如`/etc/crontab`中的MAILTO。
2. 在配置cron的时候，此时字段中的用户（如root）指的是在系统执行指令的时候，以哪个人的身份去执行相应的可执行文件（以获得不同的权限）。

